<!DOCTYPE html>
<html lang="en">
<%- include('../partials/head') %>

  <body>
    <%- include('../partials/header') %>
      <main>
        <% if (locals.errors) { %>
          <div class="errores">

            <% for(error in errors) { %>
              <p>
                <%= errors[error].msg %>
              </p>
              
            <% } %>
            
          </div>
          <% } %>
            <h1 class="tituloAdd">Editar Producto: <%= producto.nombre %>
            </h1>
            
           <form class="formEdit" action="/product/<%=producto.id%>?_method=put" method="post"
              enctype="multipart/form-data">
              <div class="edit-box">
                <div class="formIzquierda">
                  <label for="nombre">Nombre:</label>
                  <input type="text" name="nombre" id="nombre" value="<%= producto.nombre %>" />

                  <label for="precio">Precio:</label>
                  <input type="number" name="precio" id="precio" value="<%= producto.precio %>" />

                  <label for="categorias">Categorías:</label>
                  <select id="categorias" name="id_categoria">
                    <option value="opcion1" disabled>Seleccionar categoria</option>
                    <% categorias.forEach(categoria => { %>
                      <option value="<%= categoria.id %>" <% if (producto.id_categoria === categoria.id) { %>
                        selected
                      <% } %>>
                        <%= categoria.nombre %>
                      </option>
                    <% }) %>
                  </select>
                  <label>Talles disponibles :</label>
                  <div class="editar-talle">

                    <label for="talles">S <input type="number" id="talles" name="talleS"
                        value="<%=producto.talleS%>" /></label>



                    <label for="tallem">M<input type="number" id="tallem" name="talleM"
                        value="<%=producto.talleM%>" /></label>



                    <label for="tallel">L<input type="number" id="tallel" name="talleL" value="<%= producto.talleL %>" />
                    </label>


                    <label for="tallexl">XL<input type="number" id="tallexl" name="talleXL"
                        value="<%= producto.talleXL %>" /></label>


                    <label for="tallexxl">XXL<input type="number" id="tallexxl" name="talleXXL"
                        value="<%= producto.talleXXL %>" /></label>

                  </div>
                </div>
                <div class="formDerecha">
                  <label for="descripcion">Descripción:</label>
                  <textarea name="desc" id="editDescripcion"><%= producto.descripcion %></textarea>



                </div>
              </div>
              
          
              <% if (producto.imagenes) { %>
                <div class="edit-images">
                  <% producto.imagenes.forEach(element => { %>
                    <div class="edit-imagex-trash">
                      <img src="/images/productos/<%= element.nombre %>" />
                      <input type="checkbox" id="delete-<%= element.id %>" name="imgDelete" value="<%= element.id %>" />
                      <label for="delete-<%= element.id %>"><i class="fa-solid fa-trash"></i></label>
                    </div>
                  <% }) %>
                </div>
              <% } %>
              
              <div class="edit-nuevas-images">
                <label for="new-images"><i class="fa-solid fa-cloud-arrow-up"></i>Subir nuevas imágenes</label>
                <input multiple type="file" name="images" id="new-images" />
              </div>

              <span>
                <button type="submit" class="botonAdd">ACTUALIZAR</button>
                <% if (!producto.borrado) { %>
                  <a class="botonEliminar" href="/product/<%= producto.id %>/delete" >ELIMINAR ITEM</a>
                <% } else { %>
                  <a class="botonAdd" href="/product/<%= producto.id %>/alta">DAR DE ALTA</a>
                <% } %>
              </span>
              

            </form>
            
            <form method="POST" action="/product/<%=producto.id%>/delete/?_method=DELETE">
              <button hidden  id="eliminarItem"  type="submit">ELIMINAR ITEM</button> 
              </form>

              <form method="POST" action="/product/<%=producto.id%>/alta/?_method=PUT">
                <button hidden  id="altaItem"  type="submit">DAR DE ALTA</button> 
                </form>
          


            <a class="volver-producto" href="/product/<%=producto.id%>"><i class="fa-solid fa-arrow-left"></i>Volver a
              la pagina del producto</a>




      </main>
      <%- include('../partials/footer.ejs') %>
  </body>

</html>